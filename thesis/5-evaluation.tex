\chapter{Evaluation}
\label{cha:evaluation}

\section{Netzwerk-Topologien}
In den Abbildungen \ref{fig:Evaluations_Szenario_SingleHop} und \ref{fig:Evaluations_Szenario_MultiHop} ist der Aufbau der Evaluationsszenarios zu sehen. Dabei handelt es sich zum Einem um Single-Hop- und zum Anderen um Multi-Hop- Netzwerke. Die Nachrichten zur Evaluation werden dabei immer von einem Peer A zu einem Peer B und ggf. zur"uckgesendet. Jeder Peer wird dabei als Loopback-Interface an einem Rechner gestartet. Damit die Evaluationsergebnisse mit Szenarien der realen Umwelt vergleichbar sind, wurde f"ur die Evaluation ein Emulator erzeugt, welcher eine "Ubertragungsrate von 16 MBit/s emuliert.
\myfig[7 cm]{Evaluations_Szenario_SingleHop}{Single-Hop-Topologie}
\myfig{Evaluations_Szenario_MultiHop}{Multi-Hop-Topologie}

\section{Evaluationskriterien}
Zur Evaluation der Implementierung wurden zwei Kriterien verwendet:
\begin{itemize}
\item "Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se
\item "Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl
\end{itemize}
Im Folgenden werden nun diese beiden Kriterien n"aher erl"autert.

\subsection{"Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se}
Das Kriterium \emph{"Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se} zeigt das Verh"altnis der "Uber\-tra\-gungs\-dauer zu der Gr"o"se des "ubertragenen Payloads. Dabei wurden Single Request Single Response-Nachrichten in einem Single-Hop-Netzwerk versendet. Die gemessene "Uber\-tra\-gungs\-dauer entspricht dabei der Zeit vom Versand einer Nachricht bis zum Empfang der Antwort. Dabei variiert die Gr"o"se des Request-Payloads, der Response-Payload aber ist immer jeweils 1 Byte gro"s. Mittels diesem Kriterium l"asst sich feststellen wie sich die "Uber\-tra\-gungs\-dauer, in Abh"angigkeit der Gr"o"se einer Nachricht, verh"alt.

\subsection{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl}

Das Kriterium \emph{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl} berechnet das Verh"altnis der "Uber\-tra\-gungs\-dauer zu der Anzahl an Hops in einem Netzwerk. Dabei wurde die "Uber\-tra\-gungs\-dauer f"ur ein SingleHop-Netzwerk, sowie MultiHop-Netzwerke der Gr"o"se 2, 3, 4 und 5 Hops gemessen. Des weiteren wurde die "Ubertragungszeit f"ur den Nachrichtenversand mittels Uberlay, sowie f"ur den Nachrichtenversand mittels Unicast, SingleRequestSingleResponse und RPC gemessen. Daf"ur wurden Nachrichten mit einer Gr"o"se $<$ 1 Byte "uber das entsprechende Netzwerk gesendet. Die gemessene "Uber\-tra\-gungs\-dauer f"ur Uberlay und Unicast entspricht dabei der Zeit vom Versand bis zum Empfang der Nachricht. F"ur SingleRequestSingleResponse und RPC entspricht die gemessene "Uber\-tra\-gungs\-dauer der Zeit vom Versand bis zum Empfang der Antwort, wobei f"ur RPC ein BlockingService verwendet wurde. Mittels diesem Kriterium l"asst sich feststellen inwieweit sich gegebenfalls die "Uber\-tra\-gungs\-dauer eines Nachrichtentyps zu der Anzahl an Hops verh"alt.  

Bei beiden Kriterien wurde die "Ubertragungszeit in bereits verbundenen Netzwerken gemessen, d.h. die ben"otigte Zeit zum Aufbau eines Netzwerks ist hier nicht inkludiert. 

\section{Testergebnisse}
F"ur das Generieren der Testl"aufe wurden Testprogramme mit Java geschrieben, welche die oben beschriebenen Netzwerk-Topologien erzeugen und "uber diesen die Nachrichten versendet, sowie die "Uber\-tra\-gungs\-dauer misst. Diese Ergebnisse werden in sogenannten \emph{Boxplots} dargestellt. Im Folgenden werden nun Boxplots erl"autert.

\subsection{Boxplot}
Ein Boxplot ist ein Diagramm, das zur grafischen Darstellung der Verteilung von Daten verwendet werden kann. Der Boxplot vermittelt dabei schnell einen "Uberblick, in welchem Bereich die Daten liegen und wie sie sich in diesem verteilen. Ein Beispiel-Boxplot ist dabei in Abbildung \ref{fig:evaluation_example} zu erkennen. Die Verteilung wird dabei mittels eines Medians, zwei Quartilen und den beiden Whiskern dargestellt. Im Folgenden werden nun Quartile, Whisker und der Median erkl"art.
\myfig{evaluation_example}{Boxplot-Beispiel}

\nomenclature{IQR}{Interquartilsabstand}

\paragraph{Quartil}
Das Quartil, begrenzt durch das \emph{Obere Quartil} und \emph{Untere Quartil}, beschreibt die mittleren 50 \% der Werte. Die L"ange vom oberen Quartil zum unteren Quartil entspricht dabei dem Interquartilsabstand (IQR), welcher die Streuung der Werte zeigt.
\paragraph{Whisker}
Der Whisker, begrenzt durch den \emph{Oberen Whisker} und \emph{Unteren Whisker}, beschreibt den gesamten Wertebereich, sofern die Werte dabei nicht au"serhalb des 1,5 -fachen IQR zum jeweiligen Quartil liegen. Sofern ein Wert ausserhalb des 1,5-fachen IQR liegt, wird dieser als \emph{Ausrei"ser} deklariert.
\paragraph{Median}
Ein Median ist der \emph{Zentralwert}, welcher die Mitte eines Wertebereichs zeigt. Daf"ur wird der Wertebereich der Gr"o"se nach geordnet. Der Wert in der Mitte entspricht dann dem Median. Ist die Anzahl der Werte gerade, wird das arithmetische Mittel der beiden mittleren Werte berechnet. Aus diesem Grund hat der Median die Eigenschaft, dass die eine H"alfte der Werte "uber diesem und die andere darunter liegt.

Die nun im Folgenden dargestellten Ergebnisse entsprechen einer Messung von 1.00 versendeten Nachrichten. Zu Testzwecken wurden auch bis zu 1000 Nachrichten versendet und deren "Ubertragungszeit gemessen. Dabei sind die entscheidenden Ergebnisse, wie Quartile, Whisker und Medians nahezu identisch, einige Ausrei"ser allerdings sorgten f"ur eine un"ubersichtliche Darstellung, weshalb die Messung auf 100 Nachrichten beschr"ankt wurde.

\subsection{"Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se}

\myfig[12 cm]{evaluation_PayloadToOverheadSingleHopBoxPlot}{Ergebnisse: "Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se}

Die Abbildung \ref{fig:evaluation_PayloadToOverheadSingleHopBoxPlot} zeigt die gemessenen Ergebnisse des Kriteriums \emph{Payload zu "Ubertragungsdauer}.

Die x-Achse zeigt die Gr"o"se der versendeten Nachricht, wobei die Gr"o"se logarithmisch steigt. Die y-Achse zeigt die "Uber\-tra\-gungs\-dauer in Millisekunden in logarithmischer Skalierung.

Bei der Auswertung der Ergebnisse schien zun"achst verwunderlich, das sich die "Ubertragungszeiten f"ur Payloads $<=$ 1 KB scheinbar linear bei 2 Millisekunden bewegen. Da sich aber die "Ubertragungszeiten f"ur Nachrichten der Payload-Gr"o"se $<$ 1 KB, bei einer "Ubertragungsrate von 16 MBit/s im Nanosekundenbereich ver"andern, l"asst sich dies auf Messungenauigkeiten und Rundungsfehler zur"uckf"uhren. F"ur Payload-Gr"o"sen $>$ 1KB, bei der sich die "Ubertragungszeit  im Millisekundenbereich ver"andert, ist zu erkennen: erh"oht sich die Gr"o"se des Payloads logarithmisch, so steigt mit ihr auch logarithmisch die "Uber\-tra\-gungs\-dauer.

\subsection{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl}

\myfigtwo[evaluation_SingleHopVsMultiHop_UberlayVsUnicast]{Versand mittels Uberlay}{Versand von Unicast}{Ergebnisse: "Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl f"ur den Nachrichtenversand mittels Uberlay sowie den Versand von Unicast-Nachrichten}

\myfigtwo[evaluation_SingleHopVsMultiHop_SRSRVsRPC]{Versand von Single Request Single Response Nachrichten}{Aufruf mittels RPC}{Ergebnisse: "Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl f"ur den Versand von Single Request Single Response Nachrichten sowie den Aufruf mittels RPC}

Die Abbildungen \ref{fig:evaluation_SingleHopVsMultiHop_UberlayVsUnicast} und \ref{fig:evaluation_SingleHopVsMultiHop_SRSRVsRPC} zeigen die Ergebnisse des Kriteriums \emph{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl}. Die Abbildung \ref{fig:evaluation_SingleHopVsMultiHop_UberlayVsUnicast} zeigt dabei die Ergebnisse f"ur den Nachrichtenversand mittels Uberlay und dem Message Exchange Pattern Unicast. Die Abbildung \ref{fig:evaluation_SingleHopVsMultiHop_SRSRVsRPC} zeigt die Ergebnisse des Kriteriums \emph{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl} f"ur den Nachrichtenversand mittels dem Message Exchange Pattern Single Request Single Response und den Aufruf f"ur ein RPC. Die  x-Achse zeigt jeweils die Anzahl der Hops, die f"ur einen Nachrichtenversand passiert werden. Sendet beispielsweise der Peer A eine Unicast-Nachricht "uber ein 3-Hop Netzwerk an Peer B, so muss diese Nachricht 3 Hops passieren. F"ur Single Request Single Response-Nachrichten, sowie den Aufruf mittels RPC kommt dieselbe Anzahl f"ur die Antwort hinzu. In der Summe werden insgesamt also 6 Hops passiert. Auf der y-Achse ist die "Uber\-tra\-gungs\-dauer des Nachrichtenaufrufs in Millisekunden abgebildet.

Aus den Ergebnissen der Abbildung \ref{fig:evaluation_SingleHopVsMultiHop_UberlayVsUnicast} l"asst sich einerseits feststellen, dass der zu Uberlay "aquivalente Nachrichtentyp Unicast, keinen zus"atzlichen Overhead im Vergleich zum Nachrichtenversand mittels Uberlay produziert. Die vergleichbaren Mediane unterscheiden sich um maximal 1 ms, das bedeutet, die "Uber\-tra\-gungs\-dauer ist nahezu identisch, folglich produziert die Versendung von Unicast-Nachrichten keinen zus"atzlichen Overhead f"ur den Versand mittels Uberlay. Des weiteren ist zu erkennen, dass die "Uber\-tra\-gungs\-dauer linear mit der Anzahl der zu passierenden Hops steigt.

Aus den Ergebnissen der Abbildung \ref{fig:evaluation_SingleHopVsMultiHop_SRSRVsRPC} l"asst sich feststellen dass sich der vergleichbare Versand des Nachrichtentyps Single Request Single Response, der Aufruf mittels RPC nahezu identisch verh"alt. Beide Typen ben"otigen eine "ahnliche "Uber\-tra\-gungs\-dauer und steigen linear zu der Anzahl der passierten Hops. Der zus"atzliche Overhead zu Nachrichtentypen des One-way Pattern resultiert aus der Wartezeit auf die Response, welche vor allem durch die Eigenschaft herbeigef"uhrt wird, dass diese Nachrichten die doppelte Anzahl an Hops passieren.

\subsection{Schlussfolgerung}

Aus den ermittelten Ergebnissen der beiden Evaluationskriterien \emph{"Ubertragungsdauer in Abh"angigkeit der Payload-Gr"o"se} und \emph{"Ubertragungsdauer in Abh"angigkeit der Hop-Anzahl} lassen sich nun abschlie"send, f"ur den Nachrichtenversand mittels Ubermep, folgende Schlussfolgerungen ziehen:

%\begin{minipage}[t]{120 mm}
%\vspace*{3 mm}
%\hspace*{1 mm}
%\begin{minipage}[t]{120 mm}
\begin{itemize}
\item Ubermep produziert keinen zus"atzlichen Overhead zu vergleichbaren Nachrichten"ubermittlungen mittels Uberlay.
\item Die "Ubertragungszeit der Nachrichtentypen von Ubermep steigt linear in Abh"angigkeit der Anzahl der passierten Hops.
\item Die "Ubertragungszeit steigt linear in Abh"angigkeit der Gr"o"se des "uber\-tra\-genen Payloads.
\end{itemize}
%\vspace*{3 mm}
%\end{minipage}

%\end{minipage}

Des weiteren l"a"st sich sagen, das die Ergebnisse beider Kriterien durchaus akzeptabel sind und sich im Rahmen des Erwarteten bewegen. Da Ubermep f"ur den Nachrichtentransport das Uberlay-Projekt verwendet, lie"se sich eine Verbesserung vor allem durch die Reduktion der "Uber\-tra\-gungs\-dauer des Nachrichtenversands mittels Uberlay herbeif"uhren, z.B. durch die Verringerung der Aktualisierungszeit des Round Trip Time Protokolls und daraus resultierend eine Reduktion des Nachrichtenaufkommens in Uberlay. F"ur Payloads der Gr"o"se $>=$ 1 MB l"a"st sich vermutlich eine Verringerung der Verarbeitungszeit und daraus resultierend auch eine Reduktion der "Ubertragungszeit durch die Erh"ohung des Java-Heap-Space herbeif"uhren.

%\begin{table}
%\caption{Medians}
%\begin{tabular}{|c|c|c|c|c|c|}
%\hline
%Nachrichtentyp & \multicolumn{5}{c|} {Hops} \\
%%\hline 
% & \multicolumn{1}{c}{\bf 1} & \multicolumn{1}{c}{\bf 2} & \multicolumn{1}{c}{\bf 3} & \multicolumn{1}{c}{\bf 4} & \multicolumn{1}{c|}{\bf 5} \\
% \hline 
% & \multicolumn{1}{c}{\bf 1} & \multicolumn{1}{c}{\bf 2} & \multicolumn{1}{c}{\bf 3} & \multicolumn{1}{c}{\bf 4} & \multicolumn{1}{c|}{\bf 5} \\
% \hline 
%{\bf Uberlay} & 0 & 0 & 1 & 1 & 1 \\
%\hline
%{\bf Unicast} & 0 & 1 & 2 & 3 & 3 \\
%\hline
%{\bf SRSR} & 1 & 1 & 1 & 2 & 2 \\
%\hline
%{\bf RPC} & 1 & 1 & 1 & 1 & 2 \\
%\hline
%\end{tabular}
%\end{table}

%\myfigfour[evaluation_SingleHopVsMultiHopBoxPlot]{Uberlay}{Unicast}{SingleRequestSingleResponse}{RPC}{Ergebnisse SingleHop vs. MultiHop}

%\myfig[10 cm]{evaluation_SingleHopVsMultiHopUberlayBoxPlot}{Uberlay}
%\myfig[10 cm]{evaluation_SingleHopVsMultiHopUnicastBoxPlot}{Unicast}
%\myfig{evaluation_SingleHopVsMultiHopSingleRequestSingleResponseBoxPlot}{SingleRequestSingleResponse}
%\myfig{evaluation_SingleHopVsMultiHopRPCBoxPlot}{RPC}

